import{ax as Le,r as w}from"./index.2ada13a5.js";const ll=Le("production-calc",()=>{const L=w(0),W=w(0),l=w([]),ge=w(0),we=w(0),se=w(0),ke=w(0),he=w(0),xe=w(!1),ae=w(!1),Ne=w(!1),f=w({}),ee=w({}),je=w(!1),c=2,_=1/30,Fe=1/(60*30),qe=1e4,ne=w(0),le=w(0);function Ye(v={},N,P,r,u,s=[]){const a=v.ingredientPercentage;let e=1;N==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?e=r:P==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(e=u);let t=1;for(let n=0;n<s.length;n++)(s[n].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||s[n].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(t+=s[n].mult);return a*e*t/100}function Ze(v={},N,P,r,u,s=[]){const a=v.skillPercentage,e=N==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?r:P==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?u:1;let t=1;for(let n=0;n<s.length;n++)(s[n].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||s[n].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(t+=s[n].mult);return a*e*t/100}function _e(v,N,P,r,u,s,a,e=[],t={},n,M){const J=N==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?r:P==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?u:1,A=s*a;let p=0;for(let i=0;i<e.length;i++)(e[i].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||e[i].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||e[i].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(p+=e[i].mult);p=p+A>=n?n:p+A;const U=(501-v)/500*J*(1-p),k=M?.8:1;return t.frequency*U*Fe*k}function He(v,N,P,r,u,s,a,e,t,n,M,J,A,p,U,k="",i,T,S,z,H,O,R,oe,de,V,X,G,ue=0,me=[],Me=0,K="",Ce="",Ae="",C=""){l.value=[];let x=G.skill.amount[U-1],j=M.skill.amount[n-1],E=!1,pe=1;M.skill.name.includes("Charge Energy")?(E=!0,pe=1):M.skill.name.includes("Energizing Cheer")?(E=!0,pe=5):M.skill.name.includes("Energy For Everyone")?(E=!0,pe=1):M.skill.name.includes("Metronome")&&(E=!0,pe=1,i!=="proVer"?j=(N.amount[n-1]+P.amount[n-1]/5+v.amount[n-1])/(r-1):j=1e4);let We=k.split(":");const ie=parseInt(We[0],10),re=parseInt(We[1],10),fe=24*c-ie*c-re*_,Re=fe-1,Te=Re-Math.floor((fe-7*c)/2),Je=Te-6*c;function Se(y){for(const te of J)if(y>=te.e)return te.m}let ze=1;z==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ze=O,x=Math.floor(x*O),j=Math.floor(j*O)):H==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ze=R,x=Math.floor(x*R),j=Math.floor(j*R));for(let y=0;y<a.length;y++)a[y].label==="\uAE30\uB825 \uD68C\uBCF5 \uBCF4\uB108\uC2A4"&&(oe=1);const Ke=oe*de+1;let F=100/(S/c)*(ie*c+re*_)*ze*Ke;F=F>100?100:Math.floor(F);function Q(y){return y>p?p:y}if(i!=="proVer"){let Y=function(h,Z=1,$=x){let D=0;switch(h===0?D=F+$:l.value[l.value.length-1].y<=0?D=$*Z:D=l.value[l.value.length-1].y+$*Z-Math.floor(V/c),D){case D>p:return p;case D<0:return 0;default:return D}};l.value.push({x:0,y:F}),i!=="lightVer"&&(x=0);const y=i==="lightVer"?Math.floor(fe/T):0,te=ne.value>0?Math.floor(fe/ne.value):1;let o=T;for(let h=0;h<fe+1;h++){let Z=Y(h,0);if(l.value.push({x:h,y:Z}),h===0&&(o-=1),(h===Je||h===Te||h===Re)&&l.value.push({x:h,y:Q(Z+Se(Z))}),E&&(h%te===0||h===0)&&ne.value>0){let $=Y(h,1,j);l.value.push({x:h,y:Q($)}),ne.value-=1}if(h>0&&i==="lightVer"&&h%y===0&&o>0){let $=Y(h);l.value.push({x:h,y:Q($)}),o-=1}}le.value=ye("me",k,l.value[l.value.length-1].y,X,M,s,a,u,e,t,V,A)}else if(i==="proVer"){let $=function(m,g,q){let d=q>p?p:q;m>0?l.value[g].y=(l.value[g].y*m+d)/(m+1):l.value.push({x:g,y:d})},D=function(m){let g=0;return o>0&&(o=o-1*(V/c),o>p&&(o=p)),o<=0&&(o=0),l.value[m-1].y>0&&(g=l.value[m-1].y-1*(V/c),g>p&&(g=p)),g<0?0:g},Oe=function(){if(M.skill.name.includes("Metronome")){let m=0;const g=Math.random();if(g<1/(r-1))m=j*N.amount[n-1]/1e4;else if(g<2/(r-1)){const q=Math.random();q<1/5?m=j*P.amount[n-1]/1e4:q<2/5&&(o+=P.amount[n-1]*(y/G.skill.amount[U-1]))}else g<3/(r-1)?(m=j*v.amount[n-1]/1e4,o+=v.amount[n-1]*(y/G.skill.amount[U-1])):m=0;return m=Math.floor(m),o=Q(Math.floor(o)),m}else return j},y=G.skill.amount[U-1],te=1;Ae==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(te=O,y=Math.floor(y*O)):C==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(te=R,y=Math.floor(y*R));let Y=100/(S/c)*(ie*c+re*_)*te*Ke;Y=Y>100?100:Y;let o=Y,h=.8,Z=.4;for(let m=0;m<qe;m++){Math.random()<h?(o+=y,Math.random()<Z?$(m,0,Q(F+Oe()+x)):$(m,0,Q(F+x))):Math.random()<Z?$(m,0,Q(F+Oe())):$(m,0,Q(F));let g=W.value,q=L.value;for(let d=1;d<fe+1;d++){let be=function(b){for(let B=0;B<X.length;B++)if(b>X[B].e)return Ve=X[B].e,X[B].m;return X[X.length-1].m},Ue=function(b,B,ve){return(B-ve)/(V/c)+b};o=Q(o);const Qe=o;let I=D(d),Ve=0;const Xe=be(o),ce=be(Qe);let Pe=0;if(Xe!==ce){let b=Ue(d-1,Qe,Ve)-(d-1);g=g-(b/ce+(1-b)/Xe)%W.value,Pe=Math.floor((b/ce+(1-b)/Xe)/W.value)}else g=g-1/ce%W.value,Pe=Math.floor(1/ce/W.value);if(g<=0&&(Pe+=1,g+=W.value),E){let b=0;const B=be(I),ve=be(l.value[d-1].y);if(B!==ve){let Be=Ue(d-1,l.value[d-1].y,Ve)-(d-1);q=q-(Be/ve+(1-Be)/B)%L.value,b=Math.floor((Be/ve+(1-Be)/B)/L.value)}else q=q-1/ce%W.value,b=Math.floor(1/ce/W.value);q<=0&&(b+=1,q+=L.value),(d===Je||d===Te||d===Re)&&(I+=Se(I),o+=Se(o));const $e=1-Math.pow(1-se.value/pe,b);b>0&&Math.random()<$e&&(I+=Oe())}const Ie=1-Math.pow(1-ke.value,Pe);if(Pe>0&&Math.random()<Ie&&(I+=x,o+=y),$(m,d,Q(I)),o=Q(o),d===fe){let b=o,B=0;if(I-Math.ceil(V/c*(ie*c+re*_))<0?B=0:B=I-Math.ceil(V/c*(ie*c+re*_)),o-Math.ceil(V/c*(ie*c+re*_))<0?o=0:o=o-Math.ceil(V/c*(ie*c+re*_)),F=B+F>100?100:B+F,o=o+Y>100?100:o+Y,E){const $e=ye("me",k,I,X,M,s,a,u,e,t,V,A);Z=1-Math.pow(1-se.value/pe,$e)}const ve=ye("healer",k,b,X,G,ue,me,Me,K,Ce,V,A);h=1-Math.pow(1-ke.value,ve)}}}}}function Ge(v=[],N="target",P){ee.value={},v.forEach(e=>{ee.value[e.m]=0});let r=0;function u(e){for(let t=0;t<v.length;t++)if(e>v[t].e)return r=v[t].e,v[t].m;return r=v[v.length-1].e,v[v.length-1].m}function s(e,t,n){return(n-l.value[e].y)/((l.value[e].y-l.value[t].y)/(l.value[e].x-l.value[t].x))+l.value[e].x}for(let e=0;e<l.value.length-1;e++)if(l.value[e].x!==l.value[e+1].x){let t=u(l.value[e+1].y),n=l.value[e].x,M=!0,J=l.value[e+1].x;N==="proVer"&&l.value[e].y<=l.value[e+1].y&&(t=u(l.value[e].y-P/c*(l.value[e+1].x-l.value[e].x)));let A=u(l.value[e].y);for(;M;)A===t?(ee.value[A]+=l.value[e+1].x-n,M=!1):(J=s(e,e+1,r),ee.value[A]+=J-n,A=u(r),n=J)}let a=0;for(let e in ee.value)a+=ee.value[e]/parseFloat(e);he.value=Math.floor(a/L.value),ne.value=(he.value+le.value)*se.value}function Ee(v,N,P,r=!1,u={},s,a,e,t,n,M,J,A,p,U,k){v==="proVer"&&(le.value=ye("me",n,l.value[l.value.length-1].y,J,u,A,p,s,e,t,M,U));function i(T,S){let z=0;return S<30?z=u[`ingredient${S}`].amount:z=u[`ingredient${S}`].find(H=>H.ingredient.longName===T).amount,r?le.value*ge.value*z:(he.value+le.value)*ge.value*z}f.value[a]=i(a,0),s>=30&&(e===a?(f.value[a]=(f.value[a]+i(e,30))/2,xe.value=!1):(f.value[a]=f.value[a]/2,f.value[e]=i(e,30)/2,xe.value=!0),s>=60&&(f.value[a]=f.value[a]*2/3,a===e?t!==e?(f.value[t]=i(t,60)/3,ae.value=!0):(f.value[a]=f.value[a]+i(t,60)/3,ae.value=!1):(f.value[e]=f.value[e]*2/3,t===a?(f.value[a]=f.value[a]+i(t,60)/3,ae.value=!1):t===e?(f.value[e]=f.value[e]+i(t,60)/3,ae.value=!1):(f.value[t]=i(t,60)/3,ae.value=!0)))),(u.skill.unit==="ingredients"||u.skill.name==="Metronome")&&(async()=>{try{const S=await(await fetch("https://api.sleepapi.net/api/ingredient")).json(),z=u.skill.name==="Metronome"?P-1:1,H=u.skill.name==="Metronome"?Math.ceil(N.amount[k-1]/3):Math.ceil(u.skill.amount[k-1]/3),O=1-(1-1/S.length)*(1-1/(S.length-1))*(1-1/(S.length-2)),R=(he.value+le.value)*se.value*H*O/z;Ne.value=!0,f.value[a]+=R,f.value.hasOwnProperty(e)&&(f.value[e]+=R),f.value.hasOwnProperty(t)&&(f.value[t]+=R),f.value.all=R}catch(T){console.log("ing Fetch problem: "+T.message)}})()}function ye(v,N,P,r,u,s,a,e,t,n,M,J){let A=N.split(":");const p=parseInt(A[0],10),U=parseInt(A[1],10),k=v==="healer"?we.value:ge.value;let i={};r.forEach(C=>{i[C.m]=0});let T=0;function S(C){for(let x=0;x<r.length;x++)if(C>r[x].e)return T=r[x].e,r[x].m;return T=0,r[r.length-1].m}let z=S(P),H=0,O=(P-T)/(M/c);for(;z!==r[r.length-1].m;)i[z]+=O-H,z=S(T),H=O,O=(P-T)/(M/c);O=p*c+U*_,i[z]+=O-H;let R=0;for(let C in i)R+=i[C]/parseFloat(C);let oe=0;v==="me"?oe=Math.floor(R/L.value):oe=Math.floor(R/W.value);let de=!1;const V=J?1.2:1;let X=(u.carrySize+s*5)*V;for(let C=0;C<a.length;C++)a[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||a[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||a[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?X+=a[C].mult:a[C].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(de=!0);function G(C,x){return u[`ingredient${x}`].find(E=>E.ingredient.longName===C).amount}let ue=0,me=0,Me=0,K=1;switch(!0){case e>=60:K=3,ue=u.ingredient0.amount*k/K,me=G(t,30)*k/K,Me=G(n,60)*k/K;break;case e>=30:K=2,ue=u.ingredient0.amount*k/K,me=G(t,30)*k/K;break;default:K=1,ue=u.ingredient0.amount*k/K}let Ce=1;u.specialty==="berry"&&(Ce+=1),de&&(Ce+=1);const Ae=Ce*(1-k);return Math.ceil(X/(Ae+ue+me+Me))>oe?oe:Math.ceil(X/(Ae+ue+me+Me))}function De(){L.value=0,W.value=0,l.value=[],he.value=0,ge.value=0,we.value=0,se.value=0,ke.value=0,xe.value=!1,ae.value=!1,Ne.value=!1,je.value=!1,f.value={},ee.value={},ne.value=0,le.value=0}return{onlyBaseSpeed:L,onlyBaseSpeedH:W,energyAxis:l,finalSpeedCount:he,finalIngProc:ge,finalIngProcH:we,finalSkillProc:se,finalSkillProcH:ke,checkSecondDisplay:xe,checkThirdDisplay:ae,checkIngSkillDisplay:Ne,totalIngCalc:f,timeStaying:ee,calcLoading:je,convertH:c,convertM:_,convertS:Fe,simulationCount:qe,selfSkillCount:ne,helpCountSleep:le,calcIngProc:Ye,calcBaseSpeed:_e,calcEnergyCurve:He,calcSpeedWithEner:Ge,clearCalc:De,calcSleepSpeedCount:ye,calcLeveLIng:Ee,calcSkillProc:Ze}});export{ll as u};
