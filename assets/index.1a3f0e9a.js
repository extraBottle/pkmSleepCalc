var L=Object.defineProperty;var A=(t,e,n)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var y=(t,e,n)=>(A(t,typeof e!="symbol"?e+"":e,n),n);import{n as T}from"./index.79269579.js";var E=/^GTM-[0-9A-Z]+$/;function b(t){if(typeof t!="string"||!E.test(t)){let e=String(t).toUpperCase().replace(/.*-|[^0-9A-Z]/g,""),n=e.length===0?"":` Did you mean 'GTM-${e}'?`;throw new Error(`'${t}' is not a valid GTM-ID (${E}).${n}`)}}function f(t,e="dataLayer"){return t[e]||(t[e]=[]),t[e]}function u(t,e){var c,m,p,h;let n=document,i=n.createElement("script"),r=w=>{var g;(g=e.onReady)==null||g.call(e,{id:t,script:i}),i.removeEventListener("load",r)};i.addEventListener("load",r);let d=(c=e.dataLayerName)!=null?c:"dataLayer";if(f(window,d).push({event:"gtm.js","gtm.start":new Date().getTime()}),!t)return i;i.async=!e.defer,i.defer=!!(e.defer||e.compatibility),e.nonce&&i.setAttribute("nonce",e.nonce),e.scriptType&&(i.type=e.scriptType);let a=new URLSearchParams({id:t,...e.dataLayerName?{l:e.dataLayerName}:{},...(m=e.queryParams)!=null?m:{}}),l=(p=e.source)!=null?p:"https://www.googletagmanager.com/gtm.js";i.src=`${l}?${a}`;let s=(h=e.parentElement)!=null?h:n.body;if(typeof(s==null?void 0:s.appendChild)!="function")throw new Error("parentElement must be a DOM element");return s.appendChild(i),i}function k(t="https://www.googletagmanager.com/gtm.js"){return Array.from(document.getElementsByTagName("script")).some(e=>e.src.includes(t))}var N=class{constructor(t){y(this,"id");y(this,"options");y(this,"scriptElements",[]);y(this,"isInBrowserContext",()=>typeof window<"u");if(Array.isArray(t.id))for(let e of t.id)b(typeof e=="string"?e:e.id);else b(t.id);this.id=t.id,this.options={enabled:!0,debug:!1,loadScript:!0,defer:!1,compatibility:!1,dataLayerName:"dataLayer",...t},delete this.options.id}enabled(){var t;return(t=this.options.enabled)!=null?t:!0}enable(t=!0,e){if(this.options.enabled=t,this.isInBrowserContext()&&t&&!k(e)&&this.options.loadScript)if(Array.isArray(this.id))this.id.forEach(n=>{let i;typeof n=="string"?i=u(n,{...this.options}):i=u(n.id,{...this.options,queryParams:n.queryParams}),this.scriptElements.push(i)});else{let n=u(this.id,{...this.options});this.scriptElements.push(n)}}debugEnabled(){var t;return(t=this.options.debug)!=null?t:!1}debug(t){this.options.debug=t}dataLayer(){return this.isInBrowserContext()&&this.options.enabled?f(window,this.options.dataLayerName):!1}trackView(t,e,n={}){var r,d;let i=this.isInBrowserContext()&&((r=this.options.enabled)!=null?r:!1);this.options.debug&&console.log(`[GTM-Support${i?"":"(disabled)"}]: Dispatching TrackView`,{screenName:t,path:e}),i&&f(window,this.options.dataLayerName).push({...n,event:(d=this.options.trackViewEventProperty)!=null?d:"content-view","content-name":e,"content-view-name":t})}trackEvent({event:t,category:e=null,action:n=null,label:i=null,value:r=null,noninteraction:d=!1,...a}={}){var s;let l=this.isInBrowserContext()&&((s=this.options.enabled)!=null?s:!1);this.options.debug&&console.log(`[GTM-Support${l?"":"(disabled)"}]: Dispatching event`,{event:t,category:e,action:n,label:i,value:r,...a}),l&&f(window,this.options.dataLayerName).push({event:t!=null?t:"interaction",target:e,action:n,"target-properties":i,value:r,"interaction-type":d,...a})}push(t){var n;let e=this.isInBrowserContext()&&((n=this.options.enabled)!=null?n:!1);this.options.debug&&console.log(`[GTM-Support${e?"":"(disabled)"}]: Dispatching event`,t),e&&f(window,this.options.dataLayerName).push(t)}},o;function P(t,e={id:""}){e={trackOnNextTick:!1,...e},o=new N(e),t.config.globalProperties.$gtm=o,o.isInBrowserContext()&&(e.vueRouter&&$(t,e.vueRouter,e.ignoredViews,e.trackOnNextTick,e.vueRouterAdditionalEventData),o.options.enabled&&o.options.loadScript&&(Array.isArray(e.id)?e.id.forEach(n=>{if(typeof n=="string")u(n,e);else{let i={...e};n.queryParams!=null&&(i.queryParams={...i.queryParams,...n.queryParams}),u(n.id,i)}}):u(e.id,e))),t.provide("gtm",e)}function $(t,e,n=[],i,r=()=>({})){function d(a,l){return a instanceof Error?!!(a.type&l):!1}e.afterEach(async(a,l,s)=>{var h,w,g,v;if(typeof a.name!="string"||Array.isArray(n)&&n.includes(a.name)||typeof n=="function"&&n(a,l))return;let c=a.meta&&typeof a.meta.gtm=="string"&&a.meta.gtm?a.meta.gtm:a.name;d(s,4)?o!=null&&o.debugEnabled()&&console.log(`[VueGtm]: '${c}' not tracked due to navigation aborted`):d(s,8)&&(o==null?void 0:o.debugEnabled())&&console.log(`[VueGtm]: '${c}' not tracked due to navigation cancelled`);let m={...await r(a,l),...(h=a.meta)==null?void 0:h.gtmAdditionalEventData},p=(v=(g=(w=e.options)==null?void 0:w.history)==null?void 0:g.base)!=null?v:"";p.endsWith("/")||(p+="/"),p+=a.fullPath.startsWith("/")?a.fullPath.substring(1):a.fullPath,i?T(()=>{o==null||o.trackView(c,p,m)}):o==null||o.trackView(c,p,m)})}function D(t){return{install:e=>P(e,t)}}function G(){return o}export{G as E,D as N};
