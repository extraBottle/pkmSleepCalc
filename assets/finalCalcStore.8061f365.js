import{aF as ul,r as w}from"./index.6f1ce606.js";const sl=ul("production-calc",()=>{const D=w(0),Y=w(0),a=w([]),we=w(0),Be=w(0),O=w(0),$=w(0),ye=w(0),ze=w(!1),ue=w(!1),Ve=w(!1),c=w({}),L=w({}),je=w(!1),r=2,G=1/30,Ie=1/(60*30),We=1e4,ce=w(0),_e=w(0),ee=w(0);function De(f={},d,T,_,t,s=[]){const n=f.ingredient_percentage;let i=1;d==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?i=_:T==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(i=t);let o=1;for(let l=0;l<s.length;l++)(s[l].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||s[l].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(o+=s[l].mult);return n*i*o/100}function Le(f={},d,T,_,t,s=[]){const n=f.skill_percentage,i=f.pity_count,o=d==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?_:T==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?t:1;let l=1;for(let h=0;h<s.length;h++)(s[h].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||s[h].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(l+=s[h].mult);const u=n*o*l/100;let g=0;for(let h=1;h<i;h++)g+=h*Math.pow(1-u,h-1)*u;return g+=i*Math.pow(1-u,i-1),1/g}function el(f,d,T,_,t,s,n,i,o=[],l={},u,g){const h=T==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?t:_==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?s:1,p=n*i;let k=0;for(let m=0;m<o.length;m++)(o[m].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||o[m].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||o[m].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(k+=o[m].mult);k=k+p>=u?u:k+p;const S=(501-d)/500*h*(1-k)*(1-f/100),v=g?.8:1;return l.frequency*S*Ie*v}function ll(f=!1,d=100,T,_,t,s,n,i,o,l,u,g,h,p,k,S="",v,m,M,le,ae,N,q,xe,ke,A,U,Q,te=[],se=0,Me="",Pe="",H="",de="",Xe="",C=!1){a.value=[];let y=Q.main_skills.amount[k-1];Q.main_skills.name.includes("Energizing Cheer")&&(y=y/5);let V=u.main_skills.amount?u.main_skills.amount[l-1]:0,ge=!1,Ne=1;u.main_skills.name.includes("Charge Energy")?(ge=!0,Ne=1):u.main_skills.name.includes("Energizing Cheer")?(ge=!0,Ne=5):u.main_skills.name.includes("Energy For Everyone")&&(ge=!0,Ne=1);let $e=S.split(":");const re=parseInt($e[0],10),ve=parseInt($e[1],10),fe=24*r-re*r-ve*G,Fe=fe-1,Ze=Fe-Math.floor((fe-7*r)/2),Ge=Ze-6*r;function Re(z){for(const ne of g)if(z>=ne.e)return ne.m}let Ye=1;le==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(Ye=N,y=Math.floor(y*N),V=Math.floor(V*N)):ae==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(Ye=q,y=Math.floor(y*q),V=Math.floor(V*q));const Ae=f?d:100,Qe=xe*ke+1;let J=Ae/(M/r)*(re*r+ve*G)*Ye*Qe;J=J>Ae?Ae:Math.floor(J);function B(z){return z>p?p:z}if(v!=="proVer"){let K=function(e,I=1,W=y){let F=0;switch(e===0?F=J+W:a.value[a.value.length-1].y<=0?F=W*I:F=a.value[a.value.length-1].y+W*I-Math.floor(A/r),F){case F>p:return p;case F<0:return 0;default:return F}};a.value.push({x:0,y:J}),v!=="lightVer"&&(y=0);const z=v==="lightVer"?Math.floor(fe/m):0,ne=ce.value>0?Math.floor(fe/ce.value):1;let j=m;for(let e=0;e<fe+1;e++){let I=K(e,0);if(a.value.push({x:e,y:I}),e===0&&(j-=1),(e===Ge||e===Ze||e===Fe)&&a.value.push({x:e,y:B(I+Re(I))}),ge&&(e%ne===0||e===0)&&ce.value>0){let W=K(e,1,V);a.value.push({x:e,y:B(W)}),ce.value-=1}if(e>0&&v==="lightVer"&&e%z===0&&j>0){let W=K(e);a.value.push({x:e,y:B(W)}),j-=1}}ee.value=be("me",T,S,a.value[a.value.length-1].y,U,u,s,t,n,i,o,A,h)}else if(v==="proVer"){let he=function(b,Z,me){let oe=me>p?p:me;b>0?a.value[Z].y=(a.value[Z].y*b+oe)/(b+1):a.value.push({x:Z,y:oe})},ol=function(b){let Z=0;return e>0&&(e=e-1*(A/r),e>p&&(e=p)),e<=0&&(e=0),a.value[b-1].y>0&&(Z=a.value[b-1].y-1*(A/r),Z>p&&(Z=p)),Z<0?0:Z},z=Q.main_skills.amount[k-1],ne=1;de==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ne=N,z=Math.floor(z*N)):Xe==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ne=q,z=Math.floor(z*q));const K=C?d:100;let j=K/(M/r)*(re*r+ve*G)*ne*Qe;j=j>K?K:j;let e=j,I=.8,W=0,F=.4,qe=0;for(let b=0;b<We;b++){let Z=Math.random(),me=Math.random(),oe=0;Z<I?(e+=z,oe=1,Z<W&&(e+=z,e=B(Math.floor(e)),oe=2),me<F?me<qe?he(b,0,B(J+V*2+y*oe)):he(b,0,B(J+V+y*oe)):he(b,0,B(J+y*oe))):me<F?me<qe?he(b,0,B(J+V*2)):he(b,0,B(J+V)):he(b,0,B(J));let Ce=Y.value,Se=D.value;for(let X=1;X<fe+1;X++){let Oe=function(x){for(let P=0;P<U.length;P++)if(x>U[P].e)return Ue=U[P].e,U[P].m;return U[U.length-1].m},Ee=function(x,P,R){return(P-R)/(A/r)+x};e=B(e);const Ke=e;let E=ol(X),Ue=0;const He=Oe(e),pe=Oe(Ke);let Je=0;if(He!==pe){let x=Ee(X-1,Ke,Ue)-(X-1);Ce=Ce-(x/pe+(1-x)/He)%Y.value,Je=Math.floor((x/pe+(1-x)/He)/Y.value)}else Ce=Ce-1/pe%Y.value,Je=Math.floor(1/pe/Y.value);if(Ce<=0&&(Je+=1,Ce+=Y.value),ge){let x=0;const P=Oe(E),R=Oe(a.value[X-1].y);if(P!==R){let Te=Ee(X-1,a.value[X-1].y,Ue)-(X-1);Se=Se-(Te/R+(1-Te)/P)%D.value,x=Math.floor((Te/R+(1-Te)/P)/D.value)}else Se=Se-1/pe%Y.value,x=Math.floor(1/pe/Y.value);Se<=0&&(x+=1,Se+=D.value),(X===Ge||X===Ze||X===Fe)&&(E+=Re(E),e+=Re(e));const ie=1-Math.pow(1-O.value/Ne,x);x>0&&Math.random()<ie&&(E+=V)}const il=1-Math.pow(1-$.value,Je);if(Je>0&&Math.random()<il&&(E+=y,e+=z),he(b,X,B(E)),e=B(e),X===fe){let x=e,P=0;if(E-Math.ceil(A/r*(re*r+ve*G))<0?P=0:P=E-Math.ceil(A/r*(re*r+ve*G)),e-Math.ceil(A/r*(re*r+ve*G))<0?e=0:e=e-Math.ceil(A/r*(re*r+ve*G)),J=P+J>Ae?Ae:P+J,e=e+j>K?K:e+j,ge){const ie=be("me",T,S,E,U,u,s,t,n,i,o,A,h);F=1-Math.pow(1-O.value/Ne,ie),u.specialty=="skill"&&(F=ie*O.value*Math.pow(1-O.value,ie-1),qe=1-Math.pow(1-O.value,ie)-ie*O.value*Math.pow(1-O.value,ie-1))}const R=be("healer",_,S,x,U,Q,te,se,Me,Pe,H,A,h);I=1-Math.pow(1-$.value,R),Q.specialty=="skill"&&(I=R*$.value*Math.pow(1-$.value,R-1),W=1-Math.pow(1-$.value,R)-R*$.value*Math.pow(1-$.value,R-1))}}}}}function al(f=[],d="target",T,_){L.value={},f.forEach(l=>{L.value[l.m]=0});let t=0;function s(l){for(let u=0;u<f.length;u++)if(l>f[u].e)return t=f[u].e,f[u].m;return t=f[f.length-1].e,f[f.length-1].m}function n(l,u,g){return(g-a.value[l].y)/((a.value[l].y-a.value[u].y)/(a.value[l].x-a.value[u].x))+a.value[l].x}for(let l=0;l<a.value.length-1;l++)if(a.value[l].x!==a.value[l+1].x){let u=s(a.value[l+1].y),g=a.value[l].x,h=!0,p=a.value[l+1].x;d==="proVer"&&a.value[l].y<=a.value[l+1].y&&(u=s(a.value[l].y-T/r*(a.value[l+1].x-a.value[l].x)));let k=s(a.value[l].y);for(;h;)k===u?(L.value[k]+=a.value[l+1].x-g,h=!1):(p=n(l,l+1,t),L.value[k]+=p-g,k=s(t),g=p)}let i=0;for(let l in L.value)i+=L.value[l]/parseFloat(l);ye.value=Math.floor(i/D.value);const o=ee.value*O.value>_?_:ee.value*O.value;ce.value=ye.value*O.value+o,_e.value=ye.value*O.value+o}function tl(f,d,T,_=!1,t={},s,n,i,o,l,u,g,h,p,k){f==="proVer"&&(ee.value=be("me",d,l,a.value[a.value.length-1].y,g,t,h,s,n,i,o,u,p));function S(v,m){const M=t[`ingredient${m}`].find(le=>le.name===v).amount;return _?ee.value*we.value*M:(ye.value+ee.value)*we.value*M}if(c.value[n]=S(n,0),s>=30&&(i===n?(c.value[n]=(c.value[n]+S(i,30))/2,ze.value=!1):(c.value[n]=c.value[n]/2,c.value[i]=S(i,30)/2,ze.value=!0),s>=60&&(c.value[n]=c.value[n]*2/3,n===i?o!==i?(c.value[o]=S(o,60)/3,ue.value=!0):(c.value[n]=c.value[n]+S(o,60)/3,ue.value=!1):(c.value[i]=c.value[i]*2/3,o===n?(c.value[n]=c.value[n]+S(o,60)/3,ue.value=!1):o===i?(c.value[i]=c.value[i]+S(o,60)/3,ue.value=!1):(c.value[o]=S(o,60)/3,ue.value=!0)))),t.main_skills.unit==="ingredients"){if(t.main_skills.name.includes("Magnet"))(async()=>{try{const m=(await fetch("https://rxgqybcxgapiftblwttl.supabase.co/rest/v1/ingredients?select=name&limit=1",{headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4Z3F5YmN4Z2FwaWZ0Ymx3dHRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MTcyNTUsImV4cCI6MjA2NTM5MzI1NX0.IAPEGqdMdslVi305yUEsdYqh-ecVOlb82BgvXMTmpwA",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4Z3F5YmN4Z2FwaWZ0Ymx3dHRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MTcyNTUsImV4cCI6MjA2NTM5MzI1NX0.IAPEGqdMdslVi305yUEsdYqh-ecVOlb82BgvXMTmpwA",Prefer:"count=exact"}})).headers.get("content-range"),M=m?parseInt(m.split("/")[1]):null,le=Math.ceil(t.main_skills.amount[k-1]/3),ae=1-(1-1/M)*(1-1/(M-1))*(1-1/(M-2)),N=_e.value*le*ae;Ve.value=!0,c.value[n]+=N,c.value.hasOwnProperty(i)&&(c.value[i]+=N),c.value.hasOwnProperty(o)&&(c.value[o]+=N),c.value.all=N}catch(v){console.log("ing Fetch problem: "+v.message)}})();else if(t.main_skills.name.includes("Draw")){let v;switch(t.main_skills.crit_chance){case 0:v=t.main_skills.amount[k-1];break;default:v=t.main_skills.avg_amount[k-1]}const m=_e.value*v/t.main_skills.selection.length;t.main_skills.selection.forEach(M=>{c.value.hasOwnProperty(M)?c.value[M]+=m:c.value[M]=m})}}}function be(f,d,T,_,t,s,n,i,o,l,u,g,h){let p=T.split(":");const k=parseInt(p[0],10),S=parseInt(p[1],10),v=f==="healer"?Be.value:we.value;let m={};t.forEach(C=>{m[C.m]=0});let M=0;function le(C){for(let y=0;y<t.length;y++)if(C>t[y].e)return M=t[y].e,t[y].m;return M=0,t[t.length-1].m}let ae=le(_),N=0,q=(_-M)/(g/r);for(;ae!==t[t.length-1].m;)m[ae]+=q-N,ae=le(M),N=q,q=(_-M)/(g/r);q=k*r+S*G,m[ae]+=q-N;let xe=0;for(let C in m)xe+=m[C]/parseFloat(C);let ke=0;f==="me"?ke=Math.floor(xe/D.value):ke=Math.floor(xe/Y.value);let A=!1;const U=h?1.2:1;let Q=(s.carry_size+s.previous_evolutions*5)*U+d;for(let C=0;C<n.length;C++)n[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||n[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||n[C].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?Q+=n[C].mult:n[C].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(A=!0);function te(C,y){return s[`ingredient${y}`].find(V=>V.name===C).amount}let se=0,Me=0,Pe=0,H=1;switch(!0){case i>=60:H=3,se=te(o,0)*v/H,Me=te(l,30)*v/H,Pe=te(u,60)*v/H;break;case i>=30:H=2,se=te(o,0)*v/H,Me=te(l,30)*v/H;break;default:H=1,se=te(o,0)*v/H}let de=1;s.specialty==="berry"&&(de+=1),A&&(de+=1);const Xe=de*(1-v);return Math.ceil(Q/(Xe+se+Me+Pe))>ke?ke:Math.ceil(Q/(Xe+se+Me+Pe))}function nl(){D.value=0,Y.value=0,a.value=[],ye.value=0,we.value=0,Be.value=0,O.value=0,$.value=0,ze.value=!1,ue.value=!1,Ve.value=!1,je.value=!1,c.value={},L.value={},ce.value=0,_e.value=0,ee.value=0}return{onlyBaseSpeed:D,onlyBaseSpeedH:Y,energyAxis:a,finalSpeedCount:ye,finalIngProc:we,finalIngProcH:Be,finalSkillProc:O,finalSkillProcH:$,checkSecondDisplay:ze,checkThirdDisplay:ue,checkIngSkillDisplay:Ve,totalIngCalc:c,timeStaying:L,calcLoading:je,convertH:r,convertM:G,convertS:Ie,simulationCount:We,selfSkillCount:ce,fixedSelfSkillCount:_e,helpCountSleep:ee,calcIngProc:De,calcBaseSpeed:el,calcEnergyCurve:ll,calcSpeedWithEner:al,clearCalc:nl,calcSleepSpeedCount:be,calcLeveLIng:tl,calcSkillProc:Le}});export{sl as u};
