import{aE as fl,r as S}from"./index.1be2ec0c.js";const vl=fl("production-calc",()=>{const ae=S(0),q=S(0),t=S([]),we=S(0),Xe=S(0),$=S(0),D=S(0),Me=S(0),Te=S(!1),fe=S(!1),$e=S(!1),i=S({}),oe=S({}),Ue=S(!1),f=2,I=1/30,Ye=1/(60*30),Ze=1e4,ce=S(0),L=S(0);function el(v={},N,R,P,r,a=[]){const s=v.ingredientPercentage;let o=1;N==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?o=P:R==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(o=r);let n=1;for(let e=0;e<a.length;e++)(a[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||a[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(n+=a[e].mult);return s*o*n/100}function ll(v={},N,R,P,r,a=[]){const s=v.skillPercentage,o=N==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?P:R==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?r:1;let n=1;for(let e=0;e<a.length;e++)(a[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||a[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(n+=a[e].mult);return s*o*n/100}function tl(v,N,R,P,r,a,s,o,n=[],e={},h,T){const y=R==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?r:P==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?a:1,p=s*o;let k=0;for(let m=0;m<n.length;m++)(n[m].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||n[m].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||n[m].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(k+=n[m].mult);k=k+p>=h?h:k+p;const x=(501-N)/500*y*(1-k)*(1-v/100),u=T?.8:1;return e.frequency*x*Ye*u}function al(v=!1,N=100,R,P,r,a,s,o,n,e,h,T,y,p,k,x,u,m,B="",g,J,K,Q,Ce,ne,ve,de,be,C,z,U,W=[],Se=0,ze="",M="",ee="",_e="",je=!1){t.value=[];let Y=U.skill.amount[m-1],H=p.skill.amount[y-1],se=!1,Pe=1;p.skill.name.includes("Charge Energy")?(se=!0,Pe=1):p.skill.name.includes("Energizing Cheer")?(se=!0,Pe=5):p.skill.name.includes("Energy For Everyone")?(se=!0,Pe=1):p.skill.name.includes("Metronome")&&(se=!0,Pe=1,g!=="proVer"?H=(a.amount[y-1]+s.amount[y-1]/5+r.amount[y-1])/(o-1):H=1e4);let Ge=B.split(":");const he=parseInt(Ge[0],10),me=parseInt(Ge[1],10),pe=24*f-he*f-me*I,Fe=pe-1,qe=Fe-Math.floor((pe-7*f)/2),Ee=qe-6*f;function We(w){for(const ue of k)if(w>=ue.e)return ue.m}let He=1;Q==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(He=ne,Y=Math.floor(Y*ne),H=Math.floor(H*ne)):Ce==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(He=ve,Y=Math.floor(Y*ve),H=Math.floor(H*ve));const Be=v?N:100,De=de*be+1;let O=Be/(K/f)*(he*f+me*I)*He*De;O=O>Be?Be:Math.floor(O);function V(w){return w>u?u:w}if(g!=="proVer"){let le=function(l,_=1,G=Y){let j=0;switch(l===0?j=O+G:t.value[t.value.length-1].y<=0?j=G*_:j=t.value[t.value.length-1].y+G*_-Math.floor(C/f),j){case j>u:return u;case j<0:return 0;default:return j}};t.value.push({x:0,y:O}),g!=="lightVer"&&(Y=0);const w=g==="lightVer"?Math.floor(pe/J):0,ue=ce.value>0?Math.floor(pe/ce.value):1;let Z=J;for(let l=0;l<pe+1;l++){let _=le(l,0);if(t.value.push({x:l,y:_}),l===0&&(Z-=1),(l===Ee||l===qe||l===Fe)&&t.value.push({x:l,y:V(_+We(_))}),se&&(l%ue===0||l===0)&&ce.value>0){let G=le(l,1,H);t.value.push({x:l,y:V(G)}),ce.value-=1}if(l>0&&g==="lightVer"&&l%w===0&&Z>0){let G=le(l);t.value.push({x:l,y:V(G)}),Z-=1}}L.value=Ae("me",R,B,t.value[t.value.length-1].y,z,p,e,n,h,T,C,x)}else if(g==="proVer"){let ye=function(c,A,E){let ie=E>u?u:E;c>0?t.value[A].y=(t.value[A].y*c+ie)/(c+1):t.value.push({x:A,y:ie})},il=function(c){let A=0;return l>0&&(l=l-1*(C/f),l>u&&(l=u)),l<=0&&(l=0),t.value[c-1].y>0&&(A=t.value[c-1].y-1*(C/f),A>u&&(A=u)),A<0?0:A},Ne=function(){if(p.skill.name.includes("Metronome")){let c=0;const A=Math.random();if(A<1/(o-1))c=H*a.amount[y-1]/1e4;else if(A<2/(o-1)){const E=Math.random();E<1/5?c=H*s.amount[y-1]/1e4:E<2/5&&(l+=s.amount[y-1]*(w/U.skill.amount[m-1]))}else A<3/(o-1)?(c=H*r.amount[y-1]/1e4,l+=r.amount[y-1]*(w/U.skill.amount[m-1])):c=0;return c=Math.floor(c),l=V(Math.floor(l)),c}else return H},w=U.skill.amount[m-1],ue=1;ee==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ue=ne,w=Math.floor(w*ne)):_e==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ue=ve,w=Math.floor(w*ve));const le=je?N:100;let Z=le/(K/f)*(he*f+me*I)*ue*De;Z=Z>le?le:Z;let l=Z,_=.8,G=0,j=.4,Je=0;for(let c=0;c<Ze;c++){let A=Math.random(),E=Math.random(),ie=0;A<_?(l+=w,ie=1,A<G&&(l+=w,l=V(Math.floor(l)),ie=2),E<j?E<Je?ye(c,0,V(O+Ne()*2+Y*ie)):ye(c,0,V(O+Ne()+Y*ie)):ye(c,0,V(O+Y*ie))):E<j?E<Je?ye(c,0,V(O+Ne()*2)):ye(c,0,V(O+Ne())):ye(c,0,V(O));let ke=q.value,xe=ae.value;for(let X=1;X<pe+1;X++){let Oe=function(d){for(let b=0;b<z.length;b++)if(d>z[b].e)return Ke=z[b].e,z[b].m;return z[z.length-1].m},Le=function(d,b,F){return(b-F)/(C/f)+d};l=V(l);const Ie=l;let te=il(X),Ke=0;const Qe=Oe(l),ge=Oe(Ie);let Re=0;if(Qe!==ge){let d=Le(X-1,Ie,Ke)-(X-1);ke=ke-(d/ge+(1-d)/Qe)%q.value,Re=Math.floor((d/ge+(1-d)/Qe)/q.value)}else ke=ke-1/ge%q.value,Re=Math.floor(1/ge/q.value);if(ke<=0&&(Re+=1,ke+=q.value),se){let d=0;const b=Oe(te),F=Oe(t.value[X-1].y);if(b!==F){let Ve=Le(X-1,t.value[X-1].y,Ke)-(X-1);xe=xe-(Ve/F+(1-Ve)/b)%ae.value,d=Math.floor((Ve/F+(1-Ve)/b)/ae.value)}else xe=xe-1/ge%q.value,d=Math.floor(1/ge/q.value);xe<=0&&(d+=1,xe+=ae.value),(X===Ee||X===qe||X===Fe)&&(te+=We(te),l+=We(l));const re=1-Math.pow(1-$.value/Pe,d);d>0&&Math.random()<re&&(te+=Ne())}const rl=1-Math.pow(1-D.value,Re);if(Re>0&&Math.random()<rl&&(te+=Y,l+=w),ye(c,X,V(te)),l=V(l),X===pe){let d=l,b=0;if(te-Math.ceil(C/f*(he*f+me*I))<0?b=0:b=te-Math.ceil(C/f*(he*f+me*I)),l-Math.ceil(C/f*(he*f+me*I))<0?l=0:l=l-Math.ceil(C/f*(he*f+me*I)),O=b+O>Be?Be:b+O,l=l+Z>le?le:l+Z,se){const re=Ae("me",R,B,te,z,p,e,n,h,T,C,x);j=1-Math.pow(1-$.value/Pe,re),p.specialty=="skill"&&(j=re*$.value*Math.pow(1-$.value,re-1),Je=1-Math.pow(1-$.value,re)-re*$.value*Math.pow(1-$.value,re-1))}const F=Ae("healer",P,B,d,z,U,W,Se,ze,M,C,x);_=1-Math.pow(1-D.value,F),U.specialty=="skill"&&(_=F*D.value*Math.pow(1-D.value,F-1),G=1-Math.pow(1-D.value,F)-F*D.value*Math.pow(1-D.value,F-1))}}}}}function ol(v=[],N="target",R,P){oe.value={},v.forEach(e=>{oe.value[e.m]=0});let r=0;function a(e){for(let h=0;h<v.length;h++)if(e>v[h].e)return r=v[h].e,v[h].m;return r=v[v.length-1].e,v[v.length-1].m}function s(e,h,T){return(T-t.value[e].y)/((t.value[e].y-t.value[h].y)/(t.value[e].x-t.value[h].x))+t.value[e].x}for(let e=0;e<t.value.length-1;e++)if(t.value[e].x!==t.value[e+1].x){let h=a(t.value[e+1].y),T=t.value[e].x,y=!0,p=t.value[e+1].x;N==="proVer"&&t.value[e].y<=t.value[e+1].y&&(h=a(t.value[e].y-R/f*(t.value[e+1].x-t.value[e].x)));let k=a(t.value[e].y);for(;y;)k===h?(oe.value[k]+=t.value[e+1].x-T,y=!1):(p=s(e,e+1,r),oe.value[k]+=p-T,k=a(r),T=p)}let o=0;for(let e in oe.value)o+=oe.value[e]/parseFloat(e);Me.value=Math.floor(o/ae.value);const n=L.value*$.value>P?P:L.value*$.value;ce.value=Me.value*$.value+n}function nl(v,N,R,P,r=!1,a={},s,o,n,e,h,T,y,p,k,x){v==="proVer"&&(L.value=Ae("me",N,h,t.value[t.value.length-1].y,y,a,p,s,n,e,T,k));function u(m,B){let g=0;return B<30?g=a[`ingredient${B}`].amount:g=a[`ingredient${B}`].find(J=>J.ingredient.longName===m).amount,r?L.value*we.value*g:(Me.value+L.value)*we.value*g}i.value[o]=u(o,0),s>=30&&(n===o?(i.value[o]=(i.value[o]+u(n,30))/2,Te.value=!1):(i.value[o]=i.value[o]/2,i.value[n]=u(n,30)/2,Te.value=!0),s>=60&&(i.value[o]=i.value[o]*2/3,o===n?e!==n?(i.value[e]=u(e,60)/3,fe.value=!0):(i.value[o]=i.value[o]+u(e,60)/3,fe.value=!1):(i.value[n]=i.value[n]*2/3,e===o?(i.value[o]=i.value[o]+u(e,60)/3,fe.value=!1):e===n?(i.value[n]=i.value[n]+u(e,60)/3,fe.value=!1):(i.value[e]=u(e,60)/3,fe.value=!0)))),(a.skill.unit==="ingredients"||a.skill.name==="Metronome")&&(async()=>{try{const B=await(await fetch("https://api.sleepapi.net/api/ingredient")).json(),g=a.skill.name==="Metronome"?P-1:1,J=a.skill.name==="Metronome"?Math.ceil(R.amount[x-1]/3):Math.ceil(a.skill.amount[x-1]/3),K=1-(1-1/B.length)*(1-1/(B.length-1))*(1-1/(B.length-2)),Q=(Me.value+L.value)*$.value*J*K/g;$e.value=!0,i.value[o]+=Q,i.value.hasOwnProperty(n)&&(i.value[n]+=Q),i.value.hasOwnProperty(e)&&(i.value[e]+=Q),i.value.all=Q}catch(m){console.log("ing Fetch problem: "+m.message)}})()}function Ae(v,N,R,P,r,a,s,o,n,e,h,T){let y=R.split(":");const p=parseInt(y[0],10),k=parseInt(y[1],10),x=v==="healer"?Xe.value:we.value;let u={};r.forEach(M=>{u[M.m]=0});let m=0;function B(M){for(let ee=0;ee<r.length;ee++)if(M>r[ee].e)return m=r[ee].e,r[ee].m;return m=0,r[r.length-1].m}let g=B(P),J=0,K=(P-m)/(h/f);for(;g!==r[r.length-1].m;)u[g]+=K-J,g=B(m),J=K,K=(P-m)/(h/f);K=p*f+k*I,u[g]+=K-J;let Q=0;for(let M in u)Q+=u[M]/parseFloat(M);let Ce=0;v==="me"?Ce=Math.floor(Q/ae.value):Ce=Math.floor(Q/q.value);let ne=!1;const ve=T?1.2:1;let de=(a.carrySize+a.previousEvolutions*5)*ve+N;for(let M=0;M<s.length;M++)s[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||s[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||s[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?de+=s[M].mult:s[M].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(ne=!0);function be(M,ee){return a[`ingredient${ee}`].find(je=>je.ingredient.longName===M).amount}let C=0,z=0,U=0,W=1;switch(!0){case o>=60:W=3,C=a.ingredient0[0].amount*x/W,z=be(n,30)*x/W,U=be(e,60)*x/W;break;case o>=30:W=2,C=a.ingredient0[0].amount*x/W,z=be(n,30)*x/W;break;default:W=1,C=a.ingredient0[0].amount*x/W}let Se=1;a.specialty==="berry"&&(Se+=1),ne&&(Se+=1);const ze=Se*(1-x);return Math.ceil(de/(ze+C+z+U))>Ce?Ce:Math.ceil(de/(ze+C+z+U))}function ul(){ae.value=0,q.value=0,t.value=[],Me.value=0,we.value=0,Xe.value=0,$.value=0,D.value=0,Te.value=!1,fe.value=!1,$e.value=!1,Ue.value=!1,i.value={},oe.value={},ce.value=0,L.value=0}return{onlyBaseSpeed:ae,onlyBaseSpeedH:q,energyAxis:t,finalSpeedCount:Me,finalIngProc:we,finalIngProcH:Xe,finalSkillProc:$,finalSkillProcH:D,checkSecondDisplay:Te,checkThirdDisplay:fe,checkIngSkillDisplay:$e,totalIngCalc:i,timeStaying:oe,calcLoading:Ue,convertH:f,convertM:I,convertS:Ye,simulationCount:Ze,selfSkillCount:ce,helpCountSleep:L,calcIngProc:el,calcBaseSpeed:tl,calcEnergyCurve:al,calcSpeedWithEner:ol,clearCalc:ul,calcSleepSpeedCount:Ae,calcLeveLIng:nl,calcSkillProc:ll}});export{vl as u};
