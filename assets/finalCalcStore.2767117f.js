import{aE as vl,r as d}from"./index.13fb0b61.js";const hl=vl("production-calc",()=>{const ae=d(0),F=d(0),t=d([]),Ae=d(0),$e=d(0),X=d(0),D=d(0),Ce=d(0),ze=d(!1),fe=d(!1),je=d(!1),i=d({}),oe=d({}),Ye=d(!1),f=2,I=1/30,Ze=1/(60*30),_e=1e4,ce=d(0),L=d(0);function ll(s={},N,R,C,r,o=[]){const g=s.ingredientPercentage;let a=1;N==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?a=C:R==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(a=r);let n=1;for(let e=0;e<o.length;e++)(o[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||o[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(n+=o[e].mult);return g*a*n/100}function tl(s={},N,R,C,r,o=[]){const g=s.skillPercentage,a=N==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?C:R==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?r:1;let n=1;for(let e=0;e<o.length;e++)(o[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||o[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(n+=o[e].mult);return g*a*n/100}function al(s,N,R,C,r,o,g,a,n=[],e={},h,b){const q=R==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?r:C==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?o:1,m=g*a;let c=0;for(let u=0;u<n.length;u++)(n[u].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||n[u].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||n[u].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(c+=n[u].mult);c=c+m>=h?h:c+m;const ve=(501-N)/500*q*(1-c)*(1-s/100),P=b?.8:1;return e.frequency*ve*Ze*P}function ol(s=!1,N=100,R,C,r,o,g,a,n,e,h,b,q,m,c,ve,P,u,S,B="",p,J,K,Q,Pe,ne,se,be,Se,M,T,U,W=0,Be=[],Oe=0,y="",ee="",Ge="",Fe="",rl=!1){t.value=[];let Y=U.skill.amount[S-1],H=c.skill.amount[m-1],he=!1,ke=1;c.skill.name.includes("Charge Energy")?(he=!0,ke=1):c.skill.name.includes("Energizing Cheer")?(he=!0,ke=5):c.skill.name.includes("Energy For Everyone")?(he=!0,ke=1):c.skill.name.includes("Metronome")&&(he=!0,ke=1,p!=="proVer"?H=(o.amount[m-1]+g.amount[m-1]/5+r.amount[m-1])/(a-1):H=1e4);let Ee=B.split(":");const me=parseInt(Ee[0],10),pe=parseInt(Ee[1],10),ye=24*f-me*f-pe*I,qe=ye-1,We=qe-Math.floor((ye-7*f)/2),De=We-6*f;function He(k){for(const ue of ve)if(k>=ue.e)return ue.m}let Je=1;Q==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(Je=ne,Y=Math.floor(Y*ne),H=Math.floor(H*ne)):Pe==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(Je=se,Y=Math.floor(Y*se),H=Math.floor(H*se));const Ne=s?N:100,Ie=be*Se+1;let z=Ne/(K/f)*(me*f+pe*I)*Je*Ie;z=z>Ne?Ne:Math.floor(z);function O(k){return k>u?u:k}if(p!=="proVer"){let le=function(l,_=1,G=Y){let $=0;switch(l===0?$=z+G:t.value[t.value.length-1].y<=0?$=G*_:$=t.value[t.value.length-1].y+G*_-Math.floor(M/f),$){case $>u:return u;case $<0:return 0;default:return $}};t.value.push({x:0,y:z}),p!=="lightVer"&&(Y=0);const k=p==="lightVer"?Math.floor(ye/J):0,ue=ce.value>0?Math.floor(ye/ce.value):1;let Z=J;for(let l=0;l<ye+1;l++){let _=le(l,0);if(t.value.push({x:l,y:_}),l===0&&(Z-=1),(l===De||l===We||l===qe)&&t.value.push({x:l,y:O(_+He(_))}),he&&(l%ue===0||l===0)&&ce.value>0){let G=le(l,1,H);t.value.push({x:l,y:O(G)}),ce.value-=1}if(l>0&&p==="lightVer"&&l%k===0&&Z>0){let G=le(l);t.value.push({x:l,y:O(G)}),Z-=1}}L.value=de("me",R,B,t.value[t.value.length-1].y,T,c,e,h,n,b,q,M,P)}else if(p==="proVer"){let ge=function(v,x,E){let ie=E>u?u:E;v>0?t.value[x].y=(t.value[x].y*v+ie)/(v+1):t.value.push({x,y:ie})},fl=function(v){let x=0;return l>0&&(l=l-1*(M/f),l>u&&(l=u)),l<=0&&(l=0),t.value[v-1].y>0&&(x=t.value[v-1].y-1*(M/f),x>u&&(x=u)),x<0?0:x},Re=function(){if(c.skill.name.includes("Metronome")){let v=0;const x=Math.random();if(x<1/(a-1))v=H*o.amount[m-1]/1e4;else if(x<2/(a-1)){const E=Math.random();E<1/5?v=H*g.amount[m-1]/1e4:E<2/5&&(l+=g.amount[m-1]*(k/U.skill.amount[S-1]))}else x<3/(a-1)?(v=H*r.amount[m-1]/1e4,l+=r.amount[m-1]*(k/U.skill.amount[S-1])):v=0;return v=Math.floor(v),l=O(Math.floor(l)),v}else return H},k=U.skill.amount[S-1],ue=1;Ge==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ue=ne,k=Math.floor(k*ne)):Fe==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ue=se,k=Math.floor(k*se));const le=rl?N:100;let Z=le/(K/f)*(me*f+pe*I)*ue*Ie;Z=Z>le?le:Z;let l=Z,_=.8,G=0,$=.4,Ke=0;for(let v=0;v<_e;v++){let x=Math.random(),E=Math.random(),ie=0;x<_?(l+=k,ie=1,x<G&&(l+=k,l=O(Math.floor(l)),ie=2),E<$?E<Ke?ge(v,0,O(z+Re()*2+Y*ie)):ge(v,0,O(z+Re()+Y*ie)):ge(v,0,O(z+Y*ie))):E<$?E<Ke?ge(v,0,O(z+Re()*2)):ge(v,0,O(z+Re())):ge(v,0,O(z));let xe=F.value,we=ae.value;for(let V=1;V<ye+1;V++){let Ve=function(w){for(let A=0;A<T.length;A++)if(w>T[A].e)return Qe=T[A].e,T[A].m;return T[T.length-1].m},el=function(w,A,j){return(A-j)/(M/f)+w};l=O(l);const Le=l;let te=fl(V),Qe=0;const Ue=Ve(l),Me=Ve(Le);let Te=0;if(Ue!==Me){let w=el(V-1,Le,Qe)-(V-1);xe=xe-(w/Me+(1-w)/Ue)%F.value,Te=Math.floor((w/Me+(1-w)/Ue)/F.value)}else xe=xe-1/Me%F.value,Te=Math.floor(1/Me/F.value);if(xe<=0&&(Te+=1,xe+=F.value),he){let w=0;const A=Ve(te),j=Ve(t.value[V-1].y);if(A!==j){let Xe=el(V-1,t.value[V-1].y,Qe)-(V-1);we=we-(Xe/j+(1-Xe)/A)%ae.value,w=Math.floor((Xe/j+(1-Xe)/A)/ae.value)}else we=we-1/Me%F.value,w=Math.floor(1/Me/F.value);we<=0&&(w+=1,we+=ae.value),(V===De||V===We||V===qe)&&(te+=He(te),l+=He(l));const re=1-Math.pow(1-X.value/ke,w);w>0&&Math.random()<re&&(te+=Re())}const cl=1-Math.pow(1-D.value,Te);if(Te>0&&Math.random()<cl&&(te+=Y,l+=k),ge(v,V,O(te)),l=O(l),V===ye){let w=l,A=0;if(te-Math.ceil(M/f*(me*f+pe*I))<0?A=0:A=te-Math.ceil(M/f*(me*f+pe*I)),l-Math.ceil(M/f*(me*f+pe*I))<0?l=0:l=l-Math.ceil(M/f*(me*f+pe*I)),z=A+z>Ne?Ne:A+z,l=l+Z>le?le:l+Z,he){const re=de("me",R,B,te,T,c,e,h,n,b,q,M,P);$=1-Math.pow(1-X.value/ke,re),c.specialty=="skill"&&($=re*X.value*Math.pow(1-X.value,re-1),Ke=1-Math.pow(1-X.value,re)-re*X.value*Math.pow(1-X.value,re-1))}const j=de("healer",C,B,w,T,U,W,Be,Oe,y,ee,M,P);_=1-Math.pow(1-D.value,j),U.specialty=="skill"&&(_=j*D.value*Math.pow(1-D.value,j-1),G=1-Math.pow(1-D.value,j)-j*D.value*Math.pow(1-D.value,j-1))}}}}}function nl(s=[],N="target",R,C){oe.value={},s.forEach(e=>{oe.value[e.m]=0});let r=0;function o(e){for(let h=0;h<s.length;h++)if(e>s[h].e)return r=s[h].e,s[h].m;return r=s[s.length-1].e,s[s.length-1].m}function g(e,h,b){return(b-t.value[e].y)/((t.value[e].y-t.value[h].y)/(t.value[e].x-t.value[h].x))+t.value[e].x}for(let e=0;e<t.value.length-1;e++)if(t.value[e].x!==t.value[e+1].x){let h=o(t.value[e+1].y),b=t.value[e].x,q=!0,m=t.value[e+1].x;N==="proVer"&&t.value[e].y<=t.value[e+1].y&&(h=o(t.value[e].y-R/f*(t.value[e+1].x-t.value[e].x)));let c=o(t.value[e].y);for(;q;)c===h?(oe.value[c]+=t.value[e+1].x-b,q=!1):(m=g(e,e+1,r),oe.value[c]+=m-b,c=o(r),b=m)}let a=0;for(let e in oe.value)a+=oe.value[e]/parseFloat(e);Ce.value=Math.floor(a/ae.value);const n=L.value*X.value>C?C:L.value*X.value;ce.value=Ce.value*X.value+n}function ul(s,N,R,C,r=!1,o={},g,a,n,e,h,b,q,m,c,ve,P){s==="proVer"&&(L.value=de("me",N,h,t.value[t.value.length-1].y,q,o,m,c,g,n,e,b,ve));function u(S,B){let p=0;return B<30?p=o[`ingredient${B}`].amount:p=o[`ingredient${B}`].find(J=>J.ingredient.longName===S).amount,r?L.value*Ae.value*p:(Ce.value+L.value)*Ae.value*p}i.value[a]=u(a,0),g>=30&&(n===a?(i.value[a]=(i.value[a]+u(n,30))/2,ze.value=!1):(i.value[a]=i.value[a]/2,i.value[n]=u(n,30)/2,ze.value=!0),g>=60&&(i.value[a]=i.value[a]*2/3,a===n?e!==n?(i.value[e]=u(e,60)/3,fe.value=!0):(i.value[a]=i.value[a]+u(e,60)/3,fe.value=!1):(i.value[n]=i.value[n]*2/3,e===a?(i.value[a]=i.value[a]+u(e,60)/3,fe.value=!1):e===n?(i.value[n]=i.value[n]+u(e,60)/3,fe.value=!1):(i.value[e]=u(e,60)/3,fe.value=!0)))),(o.skill.unit==="ingredients"||o.skill.name==="Metronome")&&(async()=>{try{const B=await(await fetch("https://api.sleepapi.net/api/ingredient")).json(),p=o.skill.name==="Metronome"?C-1:1,J=o.skill.name==="Metronome"?Math.ceil(R.amount[P-1]/3):Math.ceil(o.skill.amount[P-1]/3),K=1-(1-1/B.length)*(1-1/(B.length-1))*(1-1/(B.length-2)),Q=(Ce.value+L.value)*X.value*J*K/p;je.value=!0,i.value[a]+=Q,i.value.hasOwnProperty(n)&&(i.value[n]+=Q),i.value.hasOwnProperty(e)&&(i.value[e]+=Q),i.value.all=Q}catch(S){console.log("ing Fetch problem: "+S.message)}})()}function de(s,N,R,C,r,o,g,a,n,e,h,b,q){let m=R.split(":");const c=parseInt(m[0],10),ve=parseInt(m[1],10),P=s==="healer"?$e.value:Ae.value;let u={};r.forEach(y=>{u[y.m]=0});let S=0;function B(y){for(let ee=0;ee<r.length;ee++)if(y>r[ee].e)return S=r[ee].e,r[ee].m;return S=0,r[r.length-1].m}let p=B(C),J=0,K=(C-S)/(b/f);for(;p!==r[r.length-1].m;)u[p]+=K-J,p=B(S),J=K,K=(C-S)/(b/f);K=c*f+ve*I,u[p]+=K-J;let Q=0;for(let y in u)Q+=u[y]/parseFloat(y);let Pe=0;s==="me"?Pe=Math.floor(Q/ae.value):Pe=Math.floor(Q/F.value);let ne=!1;const se=q?1.2:1;let be=(o.carrySize+g*5)*se+N;for(let y=0;y<a.length;y++)a[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||a[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||a[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?be+=a[y].mult:a[y].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(ne=!0);function Se(y,ee){return o[`ingredient${ee}`].find(Fe=>Fe.ingredient.longName===y).amount}let M=0,T=0,U=0,W=1;switch(!0){case n>=60:W=3,M=o.ingredient0.amount*P/W,T=Se(e,30)*P/W,U=Se(h,60)*P/W;break;case n>=30:W=2,M=o.ingredient0.amount*P/W,T=Se(e,30)*P/W;break;default:W=1,M=o.ingredient0.amount*P/W}let Be=1;o.specialty==="berry"&&(Be+=1),ne&&(Be+=1);const Oe=Be*(1-P);return Math.ceil(be/(Oe+M+T+U))>Pe?Pe:Math.ceil(be/(Oe+M+T+U))}function il(){ae.value=0,F.value=0,t.value=[],Ce.value=0,Ae.value=0,$e.value=0,X.value=0,D.value=0,ze.value=!1,fe.value=!1,je.value=!1,Ye.value=!1,i.value={},oe.value={},ce.value=0,L.value=0}return{onlyBaseSpeed:ae,onlyBaseSpeedH:F,energyAxis:t,finalSpeedCount:Ce,finalIngProc:Ae,finalIngProcH:$e,finalSkillProc:X,finalSkillProcH:D,checkSecondDisplay:ze,checkThirdDisplay:fe,checkIngSkillDisplay:je,totalIngCalc:i,timeStaying:oe,calcLoading:Ye,convertH:f,convertM:I,convertS:Ze,simulationCount:_e,selfSkillCount:ce,helpCountSleep:L,calcIngProc:ll,calcBaseSpeed:al,calcEnergyCurve:ol,calcSpeedWithEner:nl,clearCalc:il,calcSleepSpeedCount:de,calcLeveLIng:ul,calcSkillProc:tl}});export{hl as u};
