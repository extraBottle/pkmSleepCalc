import{aC as ul,r as B}from"./index.90fbc5fb.js";const rl=ul("production-calc",()=>{const ne=B(0),U=B(0),l=B([]),xe=B(0),Ve=B(0),X=B(0),D=B(0),Me=B(0),Re=B(!1),ce=B(!1),Xe=B(!1),u=B({}),ue=B({}),Qe=B(!1),f=2,I=1/30,Ue=1/(60*30),Ye=1e4,ve=B(0),L=B(0);function De(v={},$,N,C,i,t=[]){const w=v.ingredientPercentage;let a=1;$==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?a=C:N==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(a=i);let o=1;for(let e=0;e<t.length;e++)(t[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||t[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(o+=t[e].mult);return w*a*o/100}function Ie(v={},$,N,C,i,t=[]){const w=v.skillPercentage,a=$==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?C:N==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?i:1;let o=1;for(let e=0;e<t.length;e++)(t[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||t[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(o+=t[e].mult);return w*a*o/100}function Le(v,$,N,C,i,t,w,a,o=[],e={},m,h){const g=N==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?i:C==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?t:1,j=w*a;let y=0;for(let r=0;r<o.length;r++)(o[r].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||o[r].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||o[r].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(y+=o[r].mult);y=y+j>=m?m:y+j;const x=(501-$)/500*g*(1-y)*(1-v/100),P=h?.8:1;return e.frequency*x*Ue*P}function el(v,$,N,C,i,t,w,a,o,e,m,h,g,j,y,x,P,r="",k,F,R,ee,le,T,H,de,$e,S,q,J,Ce=0,be=[],Y=0,Be="",Te="",M="",te=""){l.value=[];let Z=J.skill.amount[P-1],W=g.skill.amount[h-1],se=!1,Pe=1;g.skill.name.includes("Charge Energy")?(se=!0,Pe=1):g.skill.name.includes("Energizing Cheer")?(se=!0,Pe=5):g.skill.name.includes("Energy For Everyone")?(se=!0,Pe=1):g.skill.name.includes("Metronome")&&(se=!0,Pe=1,k!=="proVer"?W=(C.amount[h-1]+i.amount[h-1]/5+N.amount[h-1])/(t-1):W=1e4);let Ze=r.split(":");const he=parseInt(Ze[0],10),me=parseInt(Ze[1],10),pe=24*f-he*f-me*I,je=pe-1,Fe=je-Math.floor((pe-7*f)/2),_e=Fe-6*f;function qe(p){for(const ie of j)if(p>=ie.e)return ie.m}let We=1;ee==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(We=T,Z=Math.floor(Z*T),W=Math.floor(W*T)):le==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(We=H,Z=Math.floor(Z*H),W=Math.floor(W*H));for(let p=0;p<o.length;p++)o[p].label==="\uAE30\uB825 \uD68C\uBCF5 \uBCF4\uB108\uC2A4"&&(de=1);const He=de*$e+1;let z=100/(R/f)*(he*f+me*I)*We*He;z=z>100?100:Math.floor(z);function O(p){return p>x?x:p}if(k!=="proVer"){let G=function(s,ae=1,K=Z){let _=0;switch(s===0?_=z+K:l.value[l.value.length-1].y<=0?_=K*ae:_=l.value[l.value.length-1].y+K*ae-Math.floor(S/f),_){case _>x:return x;case _<0:return 0;default:return _}};l.value.push({x:0,y:z}),k!=="lightVer"&&(Z=0);const p=k==="lightVer"?Math.floor(pe/F):0,ie=ve.value>0?Math.floor(pe/ve.value):1;let n=F;for(let s=0;s<pe+1;s++){let ae=G(s,0);if(l.value.push({x:s,y:ae}),s===0&&(n-=1),(s===_e||s===Fe||s===je)&&l.value.push({x:s,y:O(ae+qe(ae))}),se&&(s%ie===0||s===0)&&ve.value>0){let K=G(s,1,W);l.value.push({x:s,y:O(K)}),ve.value-=1}if(s>0&&k==="lightVer"&&s%p===0&&n>0){let K=G(s);l.value.push({x:s,y:O(K)}),n-=1}}L.value=Ae("me",v,r,l.value[l.value.length-1].y,q,g,a,o,w,e,m,S,y)}else if(k==="proVer"){let ge=function(c,A,E){let re=E>x?x:E;c>0?l.value[A].y=(l.value[A].y*c+re)/(c+1):l.value.push({x:A,y:re})},ol=function(c){let A=0;return n>0&&(n=n-1*(S/f),n>x&&(n=x)),n<=0&&(n=0),l.value[c-1].y>0&&(A=l.value[c-1].y-1*(S/f),A>x&&(A=x)),A<0?0:A},Ne=function(){if(g.skill.name.includes("Metronome")){let c=0;const A=Math.random();if(A<1/(t-1))c=W*C.amount[h-1]/1e4;else if(A<2/(t-1)){const E=Math.random();E<1/5?c=W*i.amount[h-1]/1e4:E<2/5&&(n+=i.amount[h-1]*(p/J.skill.amount[P-1]))}else A<3/(t-1)?(c=W*N.amount[h-1]/1e4,n+=N.amount[h-1]*(p/J.skill.amount[P-1])):c=0;return c=Math.floor(c),n=O(Math.floor(n)),c}else return W},p=J.skill.amount[P-1],ie=1;M==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ie=T,p=Math.floor(p*T)):te==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ie=H,p=Math.floor(p*H));let G=100/(R/f)*(he*f+me*I)*ie*He;G=G>100?100:G;let n=G,s=.8,ae=0,K=.4,_=0;for(let c=0;c<Ye;c++){let A=Math.random(),E=Math.random(),re=0;A<s?(n+=p,re=1,A<ae&&(n+=p,n=O(Math.floor(n)),re=2),E<K?E<_?ge(c,0,O(z+Ne()*2+Z*re)):ge(c,0,O(z+Ne()+Z*re)):ge(c,0,O(z+Z*re))):E<K?E<_?ge(c,0,O(z+Ne()*2)):ge(c,0,O(z+Ne())):ge(c,0,O(z));let ke=U.value,we=ne.value;for(let V=1;V<pe+1;V++){let ze=function(d){for(let b=0;b<q.length;b++)if(d>q[b].e)return Je=q[b].e,q[b].m;return q[q.length-1].m},Ee=function(d,b,Q){return(b-Q)/(S/f)+d};n=O(n);const Ge=n;let oe=ol(V),Je=0;const Ke=ze(n),ye=ze(Ge);let Se=0;if(Ke!==ye){let d=Ee(V-1,Ge,Je)-(V-1);ke=ke-(d/ye+(1-d)/Ke)%U.value,Se=Math.floor((d/ye+(1-d)/Ke)/U.value)}else ke=ke-1/ye%U.value,Se=Math.floor(1/ye/U.value);if(ke<=0&&(Se+=1,ke+=U.value),se){let d=0;const b=ze(oe),Q=ze(l.value[V-1].y);if(b!==Q){let Oe=Ee(V-1,l.value[V-1].y,Je)-(V-1);we=we-(Oe/Q+(1-Oe)/b)%ne.value,d=Math.floor((Oe/Q+(1-Oe)/b)/ne.value)}else we=we-1/ye%U.value,d=Math.floor(1/ye/U.value);we<=0&&(d+=1,we+=ne.value),(V===_e||V===Fe||V===je)&&(oe+=qe(oe),n+=qe(n));const fe=1-Math.pow(1-X.value/Pe,d);d>0&&Math.random()<fe&&(oe+=Ne())}const nl=1-Math.pow(1-D.value,Se);if(Se>0&&Math.random()<nl&&(oe+=Z,n+=p),ge(c,V,O(oe)),n=O(n),V===pe){let d=n,b=0;if(oe-Math.ceil(S/f*(he*f+me*I))<0?b=0:b=oe-Math.ceil(S/f*(he*f+me*I)),n-Math.ceil(S/f*(he*f+me*I))<0?n=0:n=n-Math.ceil(S/f*(he*f+me*I)),z=b+z>100?100:b+z,n=n+G>100?100:n+G,se){const fe=Ae("me",v,r,oe,q,g,a,o,w,e,m,S,y);K=1-Math.pow(1-X.value/Pe,fe),g.specialty=="skill"&&(K=fe*X.value*Math.pow(1-X.value,fe-1),_=1-Math.pow(1-X.value,fe)-fe*X.value*Math.pow(1-X.value,fe-1))}const Q=Ae("healer",$,r,d,q,J,Ce,be,Y,Be,Te,S,y);s=1-Math.pow(1-D.value,Q),J.specialty=="skill"&&(s=Q*D.value*Math.pow(1-D.value,Q-1),ae=1-Math.pow(1-D.value,Q)-Q*D.value*Math.pow(1-D.value,Q-1))}}}}}function ll(v=[],$="target",N,C){ue.value={},v.forEach(e=>{ue.value[e.m]=0});let i=0;function t(e){for(let m=0;m<v.length;m++)if(e>v[m].e)return i=v[m].e,v[m].m;return i=v[v.length-1].e,v[v.length-1].m}function w(e,m,h){return(h-l.value[e].y)/((l.value[e].y-l.value[m].y)/(l.value[e].x-l.value[m].x))+l.value[e].x}for(let e=0;e<l.value.length-1;e++)if(l.value[e].x!==l.value[e+1].x){let m=t(l.value[e+1].y),h=l.value[e].x,g=!0,j=l.value[e+1].x;$==="proVer"&&l.value[e].y<=l.value[e+1].y&&(m=t(l.value[e].y-N/f*(l.value[e+1].x-l.value[e].x)));let y=t(l.value[e].y);for(;g;)y===m?(ue.value[y]+=l.value[e+1].x-h,g=!1):(j=w(e,e+1,i),ue.value[y]+=j-h,y=t(i),h=j)}let a=0;for(let e in ue.value)a+=ue.value[e]/parseFloat(e);Me.value=Math.floor(a/ne.value);const o=L.value*X.value>C?C:L.value*X.value;ve.value=Me.value*X.value+o}function tl(v,$,N,C,i=!1,t={},w,a,o,e,m,h,g,j,y,x,P){v==="proVer"&&(L.value=Ae("me",$,m,l.value[l.value.length-1].y,g,t,j,y,w,o,e,h,x));function r(k,F){let R=0;return F<30?R=t[`ingredient${F}`].amount:R=t[`ingredient${F}`].find(ee=>ee.ingredient.longName===k).amount,i?L.value*xe.value*R:(Me.value+L.value)*xe.value*R}u.value[a]=r(a,0),w>=30&&(o===a?(u.value[a]=(u.value[a]+r(o,30))/2,Re.value=!1):(u.value[a]=u.value[a]/2,u.value[o]=r(o,30)/2,Re.value=!0),w>=60&&(u.value[a]=u.value[a]*2/3,a===o?e!==o?(u.value[e]=r(e,60)/3,ce.value=!0):(u.value[a]=u.value[a]+r(e,60)/3,ce.value=!1):(u.value[o]=u.value[o]*2/3,e===a?(u.value[a]=u.value[a]+r(e,60)/3,ce.value=!1):e===o?(u.value[o]=u.value[o]+r(e,60)/3,ce.value=!1):(u.value[e]=r(e,60)/3,ce.value=!0)))),(t.skill.unit==="ingredients"||t.skill.name==="Metronome")&&(async()=>{try{const F=await(await fetch("https://api.sleepapi.net/api/ingredient")).json(),R=t.skill.name==="Metronome"?C-1:1,ee=t.skill.name==="Metronome"?Math.ceil(N.amount[P-1]/3):Math.ceil(t.skill.amount[P-1]/3),le=1-(1-1/F.length)*(1-1/(F.length-1))*(1-1/(F.length-2)),T=(Me.value+L.value)*X.value*ee*le/R;Xe.value=!0,u.value[a]+=T,u.value.hasOwnProperty(o)&&(u.value[o]+=T),u.value.hasOwnProperty(e)&&(u.value[e]+=T),u.value.all=T}catch(k){console.log("ing Fetch problem: "+k.message)}})()}function Ae(v,$,N,C,i,t,w,a,o,e,m,h,g){let j=N.split(":");const y=parseInt(j[0],10),x=parseInt(j[1],10),P=v==="healer"?Ve.value:xe.value;let r={};i.forEach(M=>{r[M.m]=0});let k=0;function F(M){for(let te=0;te<i.length;te++)if(M>i[te].e)return k=i[te].e,i[te].m;return k=0,i[i.length-1].m}let R=F(C),ee=0,le=(C-k)/(h/f);for(;R!==i[i.length-1].m;)r[R]+=le-ee,R=F(k),ee=le,le=(C-k)/(h/f);le=y*f+x*I,r[R]+=le-ee;let T=0;for(let M in r)T+=r[M]/parseFloat(M);let H=0;v==="me"?H=Math.floor(T/ne.value):H=Math.floor(T/U.value);let de=!1;const $e=g?1.2:1;let S=(t.carrySize+w*5)*$e+$;for(let M=0;M<a.length;M++)a[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||a[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||a[M].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?S+=a[M].mult:a[M].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(de=!0);function q(M,te){return t[`ingredient${te}`].find(W=>W.ingredient.longName===M).amount}let J=0,Ce=0,be=0,Y=1;switch(!0){case o>=60:Y=3,J=t.ingredient0.amount*P/Y,Ce=q(e,30)*P/Y,be=q(m,60)*P/Y;break;case o>=30:Y=2,J=t.ingredient0.amount*P/Y,Ce=q(e,30)*P/Y;break;default:Y=1,J=t.ingredient0.amount*P/Y}let Be=1;t.specialty==="berry"&&(Be+=1),de&&(Be+=1);const Te=Be*(1-P);return Math.ceil(S/(Te+J+Ce+be))>H?H:Math.ceil(S/(Te+J+Ce+be))}function al(){ne.value=0,U.value=0,l.value=[],Me.value=0,xe.value=0,Ve.value=0,X.value=0,D.value=0,Re.value=!1,ce.value=!1,Xe.value=!1,Qe.value=!1,u.value={},ue.value={},ve.value=0,L.value=0}return{onlyBaseSpeed:ne,onlyBaseSpeedH:U,energyAxis:l,finalSpeedCount:Me,finalIngProc:xe,finalIngProcH:Ve,finalSkillProc:X,finalSkillProcH:D,checkSecondDisplay:Re,checkThirdDisplay:ce,checkIngSkillDisplay:Xe,totalIngCalc:u,timeStaying:ue,calcLoading:Qe,convertH:f,convertM:I,convertS:Ue,simulationCount:Ye,selfSkillCount:ve,helpCountSleep:L,calcIngProc:De,calcBaseSpeed:Le,calcEnergyCurve:el,calcSpeedWithEner:ll,clearCalc:al,calcSleepSpeedCount:Ae,calcLeveLIng:tl,calcSkillProc:Ie}});export{rl as u};
