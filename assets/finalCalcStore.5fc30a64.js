import{aF as ul,r as C}from"./index.6d82556c.js";const rl=ul("production-calc",()=>{const D=C(0),Y=C(0),a=C([]),we=C(0),Be=C(0),O=C(0),$=C(0),ye=C(0),ze=C(!1),ue=C(!1),Ve=C(!1),c=C({}),L=C({}),je=C(!1),s=2,G=1/30,Ie=1/(60*30),We=1e4,ce=C(0),_e=C(0),ee=C(0);function De(f={},N,T,w,o,r=[]){const t=f.ingredient_percentage;let i=1;N==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?i=w:T==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(i=o);let n=1;for(let l=0;l<r.length;l++)(r[l].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||r[l].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(n+=r[l].mult);return t*i*n/100}function Le(f={},N,T,w,o,r=[]){const t=f.skill_percentage,i=f.pity_count,n=N==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?w:T==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?o:1;let l=1;for(let h=0;h<r.length;h++)(r[h].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||r[h].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(l+=r[h].mult);const u=t*n*l/100;let k=0;for(let h=1;h<i;h++)k+=h*Math.pow(1-u,h-1)*u;return k+=i*Math.pow(1-u,i-1),1/k}function el(f,N,T,w,o,r,t,i,n=[],l={},u,k){const h=T==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?o:w==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?r:1,p=t*i;let M=0;for(let v=0;v<n.length;v++)(n[v].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||n[v].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||n[v].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(M+=n[v].mult);M=M+p>=u?u:M+p;const S=(501-N)/500*h*(1-M)*(1-f/100),m=k?.8:1;return l.frequency*S*Ie*m}function ll(f=!1,N=100,T,w,o,r,t,i,n,l,u,k,h,p,M,S="",m,v,x,le,ae,A,q,Pe,ke,d,U,Q,te=[],re=0,Me="",xe="",H="",Ne="",Xe="",g=!1){a.value=[];let y=Q.main_skills.amount[M-1];Q.main_skills.name.includes("Energizing Cheer")&&(y=y/5);let V=u.main_skills.amount?u.main_skills.amount[l-1]:0,ge=!1,Ae=1;u.main_skills.name.includes("Charge Energy")?(ge=!0,Ae=1):u.main_skills.name.includes("Energizing Cheer")?(ge=!0,Ae=5):u.main_skills.name.includes("Energy For Everyone")&&(ge=!0,Ae=1);let $e=S.split(":");const se=parseInt($e[0],10),ve=parseInt($e[1],10),fe=24*s-se*s-ve*G,Fe=fe-1,Ze=Fe-Math.floor((fe-7*s)/2),Ge=Ze-6*s;function Re(z){for(const ne of k)if(z>=ne.e)return ne.m}let Ye=1;le==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(Ye=A,y=Math.floor(y*A),V=Math.floor(V*A)):ae==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(Ye=q,y=Math.floor(y*q),V=Math.floor(V*q));const de=f?N:100,Qe=Pe*ke+1;let J=de/(x/s)*(se*s+ve*G)*Ye*Qe;J=J>de?de:Math.floor(J);function B(z){return z>p?p:z}if(m!=="proVer"){let K=function(e,I=1,W=y){let F=0;switch(e===0?F=J+W:a.value[a.value.length-1].y<=0?F=W*I:F=a.value[a.value.length-1].y+W*I-Math.floor(d/s),F){case F>p:return p;case F<0:return 0;default:return F}};a.value.push({x:0,y:J}),m!=="lightVer"&&(y=0);const z=m==="lightVer"?Math.floor(fe/v):0,ne=ce.value>0?Math.floor(fe/ce.value):1;let j=v;for(let e=0;e<fe+1;e++){let I=K(e,0);if(a.value.push({x:e,y:I}),e===0&&(j-=1),(e===Ge||e===Ze||e===Fe)&&a.value.push({x:e,y:B(I+Re(I))}),ge&&(e%ne===0||e===0)&&ce.value>0){let W=K(e,1,V);a.value.push({x:e,y:B(W)}),ce.value-=1}if(e>0&&m==="lightVer"&&e%z===0&&j>0){let W=K(e);a.value.push({x:e,y:B(W)}),j-=1}}ee.value=be("me",T,S,a.value[a.value.length-1].y,U,u,r,o,t,i,n,d,h)}else if(m==="proVer"){let he=function(_,Z,me){let oe=me>p?p:me;_>0?a.value[Z].y=(a.value[Z].y*_+oe)/(_+1):a.value.push({x:Z,y:oe})},ol=function(_){let Z=0;return e>0&&(e=e-1*(d/s),e>p&&(e=p)),e<=0&&(e=0),a.value[_-1].y>0&&(Z=a.value[_-1].y-1*(d/s),Z>p&&(Z=p)),Z<0?0:Z},z=Q.main_skills.amount[M-1],ne=1;Ne==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ne=A,z=Math.floor(z*A)):Xe==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ne=q,z=Math.floor(z*q));const K=g?N:100;let j=K/(x/s)*(se*s+ve*G)*ne*Qe;j=j>K?K:j;let e=j,I=.8,W=0,F=.4,qe=0;for(let _=0;_<We;_++){let Z=Math.random(),me=Math.random(),oe=0;Z<I?(e+=z,oe=1,Z<W&&(e+=z,e=B(Math.floor(e)),oe=2),me<F?me<qe?he(_,0,B(J+V*2+y*oe)):he(_,0,B(J+V+y*oe)):he(_,0,B(J+y*oe))):me<F?me<qe?he(_,0,B(J+V*2)):he(_,0,B(J+V)):he(_,0,B(J));let Se=Y.value,Ce=D.value;for(let X=1;X<fe+1;X++){let Oe=function(b){for(let P=0;P<U.length;P++)if(b>U[P].e)return Ue=U[P].e,U[P].m;return U[U.length-1].m},Ee=function(b,P,R){return(P-R)/(d/s)+b};e=B(e);const Ke=e;let E=ol(X),Ue=0;const He=Oe(e),pe=Oe(Ke);let Je=0;if(He!==pe){let b=Ee(X-1,Ke,Ue)-(X-1);Se=Se-(b/pe+(1-b)/He)%Y.value,Je=Math.floor((b/pe+(1-b)/He)/Y.value)}else Se=Se-1/pe%Y.value,Je=Math.floor(1/pe/Y.value);if(Se<=0&&(Je+=1,Se+=Y.value),ge){let b=0;const P=Oe(E),R=Oe(a.value[X-1].y);if(P!==R){let Te=Ee(X-1,a.value[X-1].y,Ue)-(X-1);Ce=Ce-(Te/R+(1-Te)/P)%D.value,b=Math.floor((Te/R+(1-Te)/P)/D.value)}else Ce=Ce-1/pe%Y.value,b=Math.floor(1/pe/Y.value);Ce<=0&&(b+=1,Ce+=D.value),(X===Ge||X===Ze||X===Fe)&&(E+=Re(E),e+=Re(e));const ie=1-Math.pow(1-O.value/Ae,b);b>0&&Math.random()<ie&&(E+=V)}const il=1-Math.pow(1-$.value,Je);if(Je>0&&Math.random()<il&&(E+=y,e+=z),he(_,X,B(E)),e=B(e),X===fe){let b=e,P=0;if(E-Math.ceil(d/s*(se*s+ve*G))<0?P=0:P=E-Math.ceil(d/s*(se*s+ve*G)),e-Math.ceil(d/s*(se*s+ve*G))<0?e=0:e=e-Math.ceil(d/s*(se*s+ve*G)),J=P+J>de?de:P+J,e=e+j>K?K:e+j,ge){const ie=be("me",T,S,E,U,u,r,o,t,i,n,d,h);F=1-Math.pow(1-O.value/Ae,ie),u.specialty=="skill"&&(F=ie*O.value*Math.pow(1-O.value,ie-1),qe=1-Math.pow(1-O.value,ie)-ie*O.value*Math.pow(1-O.value,ie-1))}const R=be("healer",w,S,b,U,Q,te,re,Me,xe,H,d,h);I=1-Math.pow(1-$.value,R),Q.specialty=="skill"&&(I=R*$.value*Math.pow(1-$.value,R-1),W=1-Math.pow(1-$.value,R)-R*$.value*Math.pow(1-$.value,R-1))}}}}}function al(f=[],N="target",T,w){L.value={},f.forEach(l=>{L.value[l.m]=0});let o=0;function r(l){for(let u=0;u<f.length;u++)if(l>f[u].e)return o=f[u].e,f[u].m;return o=f[f.length-1].e,f[f.length-1].m}function t(l,u,k){return(k-a.value[l].y)/((a.value[l].y-a.value[u].y)/(a.value[l].x-a.value[u].x))+a.value[l].x}for(let l=0;l<a.value.length-1;l++)if(a.value[l].x!==a.value[l+1].x){let u=r(a.value[l+1].y),k=a.value[l].x,h=!0,p=a.value[l+1].x;N==="proVer"&&a.value[l].y<=a.value[l+1].y&&(u=r(a.value[l].y-T/s*(a.value[l+1].x-a.value[l].x)));let M=r(a.value[l].y);for(;h;)M===u?(L.value[M]+=a.value[l+1].x-k,h=!1):(p=t(l,l+1,o),L.value[M]+=p-k,M=r(o),k=p)}let i=0;for(let l in L.value)i+=L.value[l]/parseFloat(l);ye.value=Math.floor(i/D.value);const n=ee.value*O.value>w?w:ee.value*O.value;ce.value=ye.value*O.value+n,_e.value=ye.value*O.value+n}function tl(f,N,T,w=!1,o={},r,t,i,n,l,u,k,h,p,M){f==="proVer"&&(ee.value=be("me",N,l,a.value[a.value.length-1].y,k,o,h,r,t,i,n,u,p));function S(m,v){const x=o[`ingredient${v}`].find(le=>le.name===m).amount;return w?ee.value*we.value*x:(ye.value+ee.value)*we.value*x}if(c.value[t]=S(t,0),r>=30&&(i===t?(c.value[t]=(c.value[t]+S(i,30))/2,ze.value=!1):(c.value[t]=c.value[t]/2,c.value[i]=S(i,30)/2,ze.value=!0),r>=60&&(c.value[t]=c.value[t]*2/3,t===i?n!==i?(c.value[n]=S(n,60)/3,ue.value=!0):(c.value[t]=c.value[t]+S(n,60)/3,ue.value=!1):(c.value[i]=c.value[i]*2/3,n===t?(c.value[t]=c.value[t]+S(n,60)/3,ue.value=!1):n===i?(c.value[i]=c.value[i]+S(n,60)/3,ue.value=!1):(c.value[n]=S(n,60)/3,ue.value=!0)))),o.main_skills.unit==="ingredients"){if(o.main_skills.name.includes("Magnet"))(async()=>{try{const v=(await fetch("https://rxgqybcxgapiftblwttl.supabase.co/rest/v1/ingredients?select=name&limit=1",{headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4Z3F5YmN4Z2FwaWZ0Ymx3dHRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MTcyNTUsImV4cCI6MjA2NTM5MzI1NX0.IAPEGqdMdslVi305yUEsdYqh-ecVOlb82BgvXMTmpwA",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4Z3F5YmN4Z2FwaWZ0Ymx3dHRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MTcyNTUsImV4cCI6MjA2NTM5MzI1NX0.IAPEGqdMdslVi305yUEsdYqh-ecVOlb82BgvXMTmpwA",Prefer:"count=exact"}})).headers.get("content-range"),x=v?parseInt(v.split("/")[1]):null,le=Math.ceil(o.main_skills.amount[M-1]/3),ae=1-(1-1/x)*(1-1/(x-1))*(1-1/(x-2)),A=_e.value*le*ae;Ve.value=!0,c.value[t]+=A,c.value.hasOwnProperty(i)&&(c.value[i]+=A),c.value.hasOwnProperty(n)&&(c.value[n]+=A),c.value.all=A}catch(m){console.log("ing Fetch problem: "+m.message)}})();else if(o.main_skills.name.includes("Draw")){const m=_e.value*o.main_skills.avg_amount[M-1]/o.main_skills.selection.length;o.main_skills.selection.forEach(v=>{c.value.hasOwnProperty(v)?c.value[v]+=m:c.value[v]=m})}}}function be(f,N,T,w,o,r,t,i,n,l,u,k,h){let p=T.split(":");const M=parseInt(p[0],10),S=parseInt(p[1],10),m=f==="healer"?Be.value:we.value;let v={};o.forEach(g=>{v[g.m]=0});let x=0;function le(g){for(let y=0;y<o.length;y++)if(g>o[y].e)return x=o[y].e,o[y].m;return x=0,o[o.length-1].m}let ae=le(w),A=0,q=(w-x)/(k/s);for(;ae!==o[o.length-1].m;)v[ae]+=q-A,ae=le(x),A=q,q=(w-x)/(k/s);q=M*s+S*G,v[ae]+=q-A;let Pe=0;for(let g in v)Pe+=v[g]/parseFloat(g);let ke=0;f==="me"?ke=Math.floor(Pe/D.value):ke=Math.floor(Pe/Y.value);let d=!1;const U=h?1.2:1;let Q=(r.carry_size+r.previous_evolutions*5)*U+N;for(let g=0;g<t.length;g++)t[g].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||t[g].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||t[g].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?Q+=t[g].mult:t[g].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(d=!0);function te(g,y){return r[`ingredient${y}`].find(V=>V.name===g).amount}let re=0,Me=0,xe=0,H=1;switch(!0){case i>=60:H=3,re=te(n,0)*m/H,Me=te(l,30)*m/H,xe=te(u,60)*m/H;break;case i>=30:H=2,re=te(n,0)*m/H,Me=te(l,30)*m/H;break;default:H=1,re=te(n,0)*m/H}let Ne=1;r.specialty==="berry"&&(Ne+=1),d&&(Ne+=1);const Xe=Ne*(1-m);return Math.ceil(Q/(Xe+re+Me+xe))>ke?ke:Math.ceil(Q/(Xe+re+Me+xe))}function nl(){D.value=0,Y.value=0,a.value=[],ye.value=0,we.value=0,Be.value=0,O.value=0,$.value=0,ze.value=!1,ue.value=!1,Ve.value=!1,je.value=!1,c.value={},L.value={},ce.value=0,_e.value=0,ee.value=0}return{onlyBaseSpeed:D,onlyBaseSpeedH:Y,energyAxis:a,finalSpeedCount:ye,finalIngProc:we,finalIngProcH:Be,finalSkillProc:O,finalSkillProcH:$,checkSecondDisplay:ze,checkThirdDisplay:ue,checkIngSkillDisplay:Ve,totalIngCalc:c,timeStaying:L,calcLoading:je,convertH:s,convertM:G,convertS:Ie,simulationCount:We,selfSkillCount:ce,fixedSelfSkillCount:_e,helpCountSleep:ee,calcIngProc:De,calcBaseSpeed:el,calcEnergyCurve:ll,calcSpeedWithEner:al,clearCalc:nl,calcSleepSpeedCount:be,calcLeveLIng:tl,calcSkillProc:Le}});export{rl as u};
